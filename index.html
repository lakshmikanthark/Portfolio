<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <title>Lakshmikantha R K | The Dual Portfolio</title>

  <!-- Load scripts with defer so HTML renders first -->
  <script defer src="https://cdn.tailwindcss.com"></script>
  <script defer src="https://unpkg.com/lucide@latest"></script>
  <script defer src="https://unpkg.com/@studio-freight/lenis@1.0.42/dist/lenis.min.js"></script>
  <script defer src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
  <script defer src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/ScrollTrigger.min.js"></script>

  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link
    href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Oswald:wght@400;500;700&family=Teko:wght@300;400;500;600;700&display=swap"
    rel="stylesheet"
  />

  <style>
    :root {
      --eng-bg: #f8fafc;
      --eng-text: #0f172a;
      --cre-bg: #050505;
      --cre-text: #ffffff;
      --accent: #ff0000;
    }

    body {
      margin: 0;
      overflow-x: hidden;
      background: #000;
      cursor: none;
      font-family: "Inter", sans-serif;
      -webkit-tap-highlight-color: transparent;
    }

    .hidden-section { display: none !important; }
    ::selection { background: var(--accent); color: #fff; }
    html.lenis { height: auto; }
    .lenis.lenis-smooth { scroll-behavior: auto; }

    .tea-font { font-family: "Teko", sans-serif; text-transform: uppercase; line-height: 0.9; }
    .sde-font { font-family: "Inter", sans-serif; }

    .mega-text { font-size: clamp(3.5rem, 15vw, 12rem); }
    .display-text { font-size: clamp(2rem, 8vw, 6rem); }

    /* Noise overlay (disabled on mobile via media query) */
    .noise {
      position: fixed; top: 0; left: 0; width: 100%; height: 100%;
      pointer-events: none; z-index: 9000; opacity: 0.04;
      background: url("https://grainy-gradients.vercel.app/noise.svg");
    }

    /* Custom cursor (disabled on mobile via media query) */
    .cursor-dot, .cursor-outline {
      position: fixed;
      top: 0; left: 0;
      transform: translate(-50%, -50%);
      border-radius: 50%;
      z-index: 9999;
      pointer-events: none;
    }
    .cursor-dot {
      width: 8px; height: 8px; background: white;
      mix-blend-mode: difference;
      transition: transform 0.2s;
    }
    .cursor-outline {
      width: 40px; height: 40px;
      border: 1px solid rgba(255, 255, 255, 0.5);
      transition: width 0.2s, height 0.2s, background-color 0.2s;
      mix-blend-mode: difference;
    }
    body.hovered .cursor-outline {
      width: 80px; height: 80px;
      background-color: rgba(255, 255, 255, 0.1);
      border-color: transparent;
    }
    body.hovered .cursor-dot { transform: scale(0); }

    /* Preloader */
    #preloader {
      position: fixed; inset: 0; z-index: 10000;
      display: flex; flex-direction: column;
      transition: opacity 0.5s ease;
    }
    body.skip-loader #preloader { display: none !important; }

    .curtain-top, .curtain-bottom {
      width: 100%; height: 50%; background: #000;
      display: flex; align-items: flex-end; justify-content: center;
    }
    .curtain-bottom { align-items: flex-start; border-top: 1px solid #333; }

    .loader-logo {
      font-family: "Teko", sans-serif;
      font-size: 5vw;
      color: white;
      letter-spacing: 10px;
      opacity: 0;
      animation: flashLogo 1s forwards 0.5s;
    }
    @keyframes flashLogo {
      0% { opacity: 0; transform: scale(0.9); }
      100% { opacity: 1; transform: scale(1); }
    }

    /* Split screen */
    #split-screen {
      display: flex;
      width: 100vw;
      height: 100vh;
      position: fixed;
      z-index: 5000;
      top: 0;
      left: 0;
      transition: transform 1s cubic-bezier(0.87, 0, 0.13, 1);
    }

    .split {
      flex: 1;
      height: 100%;
      transition: flex 0.8s cubic-bezier(0.22, 1, 0.36, 1);
      position: relative;
      cursor: pointer;
      overflow: hidden;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      touch-action: manipulation;
    }
    @media (min-width: 768px) { .split:hover { flex: 1.4; } }

    .split-left { background: var(--eng-bg); color: var(--eng-text); border-right: 1px solid rgba(0,0,0,0.05); }
    .split-right { background: var(--cre-bg); color: var(--cre-text); }

    /* Navbar */
    .nav-pill-container {
      position: fixed;
      bottom: 30px;
      left: 50%;
      transform: translateX(-50%);
      z-index: 99999;
      display: flex;
      justify-content: center;
      opacity: 0;
      width: auto;
      max-width: 95vw;
    }

    .nav-pill {
      background: #111;
      border: 2px solid rgba(255, 255, 255, 0.15);
      border-radius: 100px;
      padding: 4px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      box-shadow: 0 20px 40px rgba(0,0,0,0.6);
      transition: all 0.4s cubic-bezier(0.16, 1, 0.3, 1);
      height: 64px;
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
    }

    .nav-pill.blue-mode {
      background: rgba(15, 23, 42, 0.95);
      border-color: #3b82f6;
      box-shadow: 0 10px 30px rgba(59, 130, 246, 0.3);
    }
    .nav-pill.red-mode {
      background: rgba(10, 10, 10, 0.95);
      border-color: #ef4444;
      box-shadow: 0 10px 30px rgba(239, 68, 68, 0.3);
    }

    .nav-avatar {
      width: 48px; height: 48px;
      border-radius: 50%;
      overflow: hidden;
      border: 2px solid rgba(255,255,255,0.2);
      flex-shrink: 0;
      margin-right: 4px;
    }
    .nav-avatar img { width: 100%; height: 100%; object-fit: cover; }

    .nav-links-wrapper {
      width: 0;
      opacity: 0;
      overflow: hidden;
      transition: all 0.5s cubic-bezier(0.16, 1, 0.3, 1);
      display: flex;
      align-items: center;
    }
    .nav-pill-container.expanded .nav-links-wrapper {
      width: auto;
      opacity: 1;
      margin: 0 2px;
      overflow: visible;
    }
    .nav-links { display: flex; gap: 0px; white-space: nowrap; }

    .nav-link {
      padding: 8px 10px;
      border-radius: 100px;
      font-family: "Teko", sans-serif;
      font-size: 1.1rem;
      letter-spacing: 0.5px;
      color: #888;
      text-decoration: none;
      transition: 0.2s;
      text-transform: uppercase;
      touch-action: manipulation;
    }
    .nav-link:active, .nav-link:hover { color: white; background: rgba(255,255,255,0.15); }
    .nav-link.switch-btn { color: #ff5555; font-weight: 600; cursor: pointer; }

    .nav-pill.blue-mode .nav-link { color: #94a3b8; }
    .nav-pill.blue-mode .nav-link:active { color: #fff; background: rgba(59, 130, 246, 0.3); }
    .nav-pill.blue-mode .nav-link.switch-btn { color: #60a5fa; }

    .nav-cta {
      background: #ff0000;
      color: white;
      border-radius: 100px;
      height: 48px;
      padding: 0 16px;
      display: flex;
      align-items: center;
      font-family: "Inter", sans-serif;
      font-weight: 700;
      font-size: 0.8rem;
      text-transform: uppercase;
      transition: 0.2s;
      white-space: nowrap;
      flex-shrink: 0;
      border: none;
      cursor: pointer;
      touch-action: manipulation;
    }
    .nav-cta:active { transform: scale(0.95); }
    .nav-pill.blue-mode .nav-cta { background: #3b82f6; }

    /* Contact popup */
    .contact-popup {
      position: absolute;
      bottom: 110%;
      right: 0;
      width: 220px;
      padding-bottom: 10px;
      opacity: 0;
      pointer-events: none;
      transition: all 0.3s cubic-bezier(0.16, 1, 0.3, 1);
      transform: translateY(10px) scale(0.95);
      z-index: 10;
      transform-origin: bottom right;
    }
    .contact-popup.active { opacity: 1; pointer-events: auto; transform: translateY(0) scale(1); }

    .contact-card {
      background: #111;
      border: 1px solid #333;
      border-radius: 16px;
      padding: 12px;
      display: flex;
      flex-direction: column;
      gap: 4px;
      box-shadow: 0 20px 60px rgba(0,0,0,0.8);
    }

    .popup-item {
      display: flex;
      align-items: center;
      gap: 12px;
      padding: 12px 16px;
      border-radius: 8px;
      color: #ccc;
      text-decoration: none;
      font-size: 1rem;
      font-weight: 500;
      transition: 0.2s;
    }
    .popup-item:active { background: #333; color: white; }
    .popup-item i { width: 18px; height: 18px; stroke-width: 2px; }

    /* Creator top */
    .mask-container {
      position: relative;
      width: 100%;
      height: 100vh;
      overflow: hidden;
      display: flex;
      align-items: center;
      justify-content: center;
      background: #000;
    }

    .masked-bg {
      position: absolute;
      top: 0; left: 0;
      width: 100%; height: 100%;
      object-fit: cover;
      z-index: 1;
      filter: grayscale(100%) sepia(100%) hue-rotate(-50deg) saturate(600%) contrast(1.2);
      opacity: 1;
    }

    .mask-overlay {
      position: absolute; inset: 0;
      background: rgba(255,0,0,0.2);
      z-index: 2;
      pointer-events: none;
      mix-blend-mode: overlay;
    }

    .mask-text {
      position: absolute;
      top: 0; left: 0;
      width: 100%; height: 100vh;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      z-index: 3;
      pointer-events: none;
      mix-blend-mode: difference;
      text-align: center;
    }

    .gallery-section { padding: 60px 0; overflow: hidden; background: #050505; }
    .gallery-track {
      display: flex;
      gap: 20px;
      padding: 0 5vw;
      overflow-x: auto;
      scroll-behavior: smooth;
      -webkit-overflow-scrolling: touch;
      -ms-overflow-style: none;
      scrollbar-width: none;
      cursor: grab;
      white-space: nowrap;
    }
    .gallery-track:active { cursor: grabbing; }
    .gallery-track::-webkit-scrollbar { display: none; }

    .poster-item {
      min-width: 280px;
      height: 420px;
      position: relative;
      transition: transform 0.4s ease;
      cursor: pointer;
      filter: grayscale(100%);
      flex-shrink: 0;
      border-radius: 8px;
      overflow: hidden;
      touch-action: pan-x;
    }
    .poster-item:active, .poster-item:hover { transform: scale(0.96); filter: grayscale(0%); }
    .poster-item img { width: 100%; height: 100%; object-fit: cover; transition: transform 0.5s; pointer-events: none; }
    .poster-item:active img, .poster-item:hover img { transform: scale(1.1); }

    @media (min-width: 768px) {
      .poster-item { min-width: 350px; height: 500px; }
      .poster-item:hover { transform: scale(0.98); }
    }

    /* Bento */
    .bento-grid {
      display: grid;
      grid-template-columns: repeat(12, 1fr);
      grid-template-rows: 350px 550px 375px;
      gap: 20px;
      padding: 20px;
      max-width: 1400px;
      margin: 0 auto;
    }
    .bento-item {
      position: relative;
      border-radius: 4px;
      overflow: hidden;
      border: 1px solid #222;
      background: #111;
      transition: border-color 0.3s ease;
      cursor: pointer;
      display: flex;
      flex-direction: column;
      justify-content: flex-end;
      padding: 30px;
      touch-action: manipulation;
    }
    .bento-item:hover, .bento-item:active { border-color: var(--accent); }
    .bento-item h3 {
      font-size: 3rem;
      font-family: "Teko", sans-serif;
      color: white;
      margin-bottom: 5px;
      position: relative;
      z-index: 2;
      line-height: 0.9;
    }
    .bento-item p {
      color: #888;
      font-size: 1rem;
      position: relative;
      z-index: 2;
      font-family: "Inter", sans-serif;
    }

    .bento-bg {
      position: absolute;
      top: -30%;
      left: 0;
      width: 100%;
      height: 130%;
      object-fit: cover;
      opacity: 0.4;
      transition: opacity 0.3s, transform 0.7s;
      z-index: 1;
      filter: grayscale(100%);
    }
    .bento-item:hover .bento-bg, .bento-item:active .bento-bg {
      opacity: 0.7;
      transform: scale(1.05);
      filter: grayscale(0%);
    }

    .b-video { grid-column: span 8; }
    .b-growth { grid-column: span 4; }
    .b-posters { grid-column: span 4; grid-row: span 2; background: #000; }
    .b-strategy { grid-column: span 12; }

    /* 3D Ring */
    #circular-gallery {
      position: fixed;
      inset: 0;
      background: #000;
      z-index: 6000;
      opacity: 0;
      pointer-events: none;
      transition: opacity 1s cubic-bezier(0.16, 1, 0.3, 1);
      overflow: hidden;
      perspective: 2000px;
    }
    #circular-gallery.active { opacity: 1; pointer-events: auto; }
    .ring-bg-container {
      position: absolute; inset: 0;
      z-index: 0;
      pointer-events: none;
      opacity: 0.2;
      filter: blur(60px);
      transform: scale(1.2);
      transition: transform 2s ease;
    }
    .ring-bg-img {
      position: absolute; inset: 0;
      width: 100%; height: 100%;
      object-fit: cover;
      transition: opacity 0.8s ease;
      opacity: 0;
    }
    .ring-bg-img.active { opacity: 1; }

    .ring-container {
      position: absolute;
      top: 50%;
      left: 50%;
      width: 0;
      height: 0;
      transform-style: preserve-3d;
    }

    .ring-center-text {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      text-align: center;
      pointer-events: none;
      z-index: 10;
      mix-blend-mode: exclusion;
    }
    .ring-center-text h2 {
      font-size: 8vw;
      color: #fff;
      font-family: "Teko", sans-serif;
      line-height: 0.8;
      letter-spacing: -2px;
    }
    .ring-center-text p {
      font-size: 1rem;
      color: #fff;
      letter-spacing: 0.5em;
      margin-top: 20px;
      font-weight: 600;
      opacity: 0.7;
    }

    .ring-item {
      position: absolute;
      width: 300px;
      height: 420px;
      left: -150px;
      top: -210px;
      background: #000;
      border: 1px solid #333;
      overflow: hidden;
      transform-style: preserve-3d;
      backface-visibility: hidden;
      cursor: pointer;
      box-shadow: 0 0 50px rgba(0,0,0,1);
      touch-action: manipulation;
    }
    .ring-item img {
      width: 100%; height: 100%;
      object-fit: cover;
      opacity: 0.6;
      transition: opacity 0.4s, transform 0.4s;
      pointer-events: none;
    }
    .ring-item:hover, .ring-item:active { border-color: red; }
    .ring-item:hover img, .ring-item:active img { opacity: 1; transform: scale(1.05); }

    .yza-header {
      position: absolute;
      top: 40px; left: 0;
      width: 100%;
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 0 40px;
      z-index: 20;
      pointer-events: none;
    }
    .yza-back {
      font-family: "Teko", sans-serif;
      font-size: 2rem;
      color: white;
      cursor: pointer;
      pointer-events: auto;
      transition: 0.3s;
      text-transform: uppercase;
      letter-spacing: 1px;
      touch-action: manipulation;
    }
    .yza-back:active { color: var(--accent); transform: scale(0.9); }

    #poster-modal {
      position: fixed;
      inset: 0;
      z-index: 999999;
      background: rgba(0,0,0,0.98);
      display: flex;
      align-items: center;
      justify-content: center;
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.3s;
    }
    #poster-modal.open { opacity: 1; pointer-events: auto; }
    #modal-img { max-height: 85vh; max-width: 90vw; box-shadow: 0 0 100px rgba(255,0,0,0.2); }
    .close-modal {
      position: absolute;
      top: 40px; right: 40px;
      color: white;
      font-size: 40px;
      cursor: pointer;
      transition: 0.3s;
      touch-action: manipulation;
    }
    .close-modal:active { color: red; transform: rotate(90deg); }

    /* Cards */
    .sde-card {
      background: #fff;
      border: 1px solid #e2e8f0;
      transition: all 0.4s cubic-bezier(0.16, 1, 0.3, 1);
      position: relative;
      overflow: hidden;
      touch-action: manipulation;
    }
    .sde-card:active, .sde-card:hover {
      transform: scale(0.98) translateY(-5px);
      box-shadow: 0 20px 40px -10px rgba(0,0,0,0.1);
      border-color: #cbd5e1;
    }
    .sde-card::before {
      content: "";
      position: absolute;
      top: 0; left: 0;
      width: 4px; height: 100%;
      background: #0f172a;
      transform: scaleY(0);
      transition: transform 0.4s ease;
      transform-origin: bottom;
    }
    .sde-card:active::before, .sde-card:hover::before { transform: scaleY(1); }

    .eng-social-btn {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 10px;
      padding: 16px 32px;
      border-radius: 4px;
      font-weight: 600;
      transition: transform 0.2s ease, background 0.3s;
      text-transform: uppercase;
      letter-spacing: 1px;
      font-size: 0.9rem;
      touch-action: manipulation;
    }
    .eng-btn-primary { background: #0f172a; color: white; border: 1px solid #0f172a; }
    .eng-btn-primary:active, .eng-btn-primary:hover { background: #1e293b; transform: scale(0.98); }
    .eng-btn-outline { background: transparent; color: #0f172a; border: 1px solid #cbd5e1; }
    .eng-btn-outline:active, .eng-btn-outline:hover { background: #f1f5f9; border-color: #0f172a; transform: scale(0.98); }

    .monkey-img {
      width: 100%;
      max-width: 300px;
      border-radius: 0;
      border: 1px solid #333;
      transition: transform 0.5s;
    }
    .monkey-img:hover, .monkey-img:active {
      transform: scale(1.02) rotate(-1deg);
      border-color: red;
    }

    .tea-link {
      position: relative;
      text-decoration: none;
      color: #666;
      transition: 0.4s cubic-bezier(0.16, 1, 0.3, 1);
      display: block;
      width: fit-content;
    }
    .tea-link:active, .tea-link:hover { color: #fff; transform: translateX(10px); }

    .neon-glow {
      transition: text-shadow 1.5s ease-in-out;
      color: #fff;
    }
    .split-right:hover .neon-glow {
      text-shadow: 0 0 20px #ff0000, 0 0 40px #ff0000, 0 0 80px #ff0000;
    }

    .manifesto-scroller {
      white-space: nowrap;
      overflow: hidden;
      width: 100%;
      border-top: 1px solid #333;
      border-bottom: 1px solid #333;
      padding: 20px 0;
      background: #0a0a0a;
    }
    .manifesto-track { display: inline-block; animation: marquee 20s linear infinite; }
    .manifesto-text {
      font-family: "Teko", sans-serif;
      font-size: 5rem;
      color: transparent;
      -webkit-text-stroke: 1px #333;
      margin-right: 50px;
    }
    @keyframes marquee {
      0% { transform: translateX(0); }
      100% { transform: translateX(-50%); }
    }

    .contact-section {
      position: relative;
      background: #050505;
      background-image: url("https://images.unsplash.com/photo-1614730341194-75c60740a2d3?w=1600&q=80");
      background-size: cover;
      background-position: center;
      padding: 100px 20px 200px 20px;
    }
    .contact-glass {
      background: rgba(255, 255, 255, 0.03);
      backdrop-filter: blur(20px);
      -webkit-backdrop-filter: blur(20px);
      border: 1px solid rgba(255, 255, 255, 0.1);
      border-radius: 20px;
      padding: 60px;
      max-width: 1300px;
      margin: 0 auto;
    }

    /* MOBILE OPTIMIZATIONS */
    @media (max-width: 768px) {
      #split-screen { flex-direction: column; }
      .split { width: 100%; height: 50%; border-right: none; border-bottom: 1px solid #333; }

      /* NAV SHOW INSTANTLY */
      .nav-pill-container { opacity: 1 !important; width: auto; max-width: 98vw; bottom: 25px; }

      .nav-link { padding: 6px 8px; font-size: 0.95rem; }
      .nav-cta { padding: 0 12px; font-size: 0.75rem; }

      /* BENTO stack */
      .bento-grid { display: flex; flex-direction: column; height: auto; }
      .bento-item { height: 300px; padding: 20px; }
      .b-strategy { height: 250px !important; }
      .bento-item h3 { font-size: 2.5rem; }

      /* Gallery smaller */
      .poster-item { min-width: 260px; height: 380px; }

      /* Split text visible */
      .split .reveal-elem { opacity: 1 !important; transform: translateY(0) !important; }
      .split-right .neon-glow { text-shadow: 0 0 10px #ff0000; }

      .mega-text { font-size: 4rem; }
      .display-text { font-size: 2.5rem; }
      .ring-center-text h2 { font-size: 4rem; }

      .contact-glass { padding: 25px; }
      .yza-header { padding: 0 20px; top: 20px; }
      .close-modal { top: 20px; right: 20px; }

      .ring-item { width: 200px; height: 300px; left: -100px; top: -150px; }
      .ring-center-text p { font-size: 0.8rem; }

      /* KILL HEAVY MOBILE PERF */
      .cursor-dot, .cursor-outline, .noise { display: none !important; }
      body { cursor: auto !important; }
    }
  </style>
</head>

<body class="sde-font">
  <div class="noise"></div>
  <div class="cursor-dot"></div>
  <div class="cursor-outline"></div>

  <div id="preloader">
    <div class="curtain-top"><div class="loader-logo">LAKSHMIKANTHA R K</div></div>
    <div class="curtain-bottom"></div>
  </div>

  <script>
    (function () {
      const savedWorld = localStorage.getItem("activeWorld");
      if (savedWorld) document.body.classList.add("skip-loader");
    })();
  </script>

  <div class="nav-pill-container" id="floating-nav">
    <div class="nav-pill">
      <div class="nav-avatar"><img src="LK.png" alt="LK" /></div>

      <div class="nav-links-wrapper">
        <div class="nav-links">
          <a href="#" class="nav-link" id="nav-home">HOME</a>
          <a href="#" class="nav-link" id="nav-work">WORK</a>
          <a href="#" class="nav-link" id="nav-about">ABOUT</a>
          <a href="#" onclick="handleSwitch()" class="nav-link switch-btn">SWITCH</a>
        </div>
      </div>

      <div class="contact-wrapper">
        <button onclick="toggleContact()" class="nav-cta" id="contact-trigger">CONTACT</button>
        <div class="contact-popup" id="contact-popup">
          <div class="contact-card">
            <a href="mailto:Lakshmikanthark20@gmail.com" class="popup-item"><i data-lucide="mail"></i> Email</a>
            <a href="tel:+919901456389" class="popup-item"><i data-lucide="phone"></i> Phone</a>
            <a href="https://linkedin.com/in/lakshmikantha-r-k" target="_blank" class="popup-item"><i data-lucide="linkedin"></i> LinkedIn</a>
            <a href="https://instagram.com/tea.bengaluru" target="_blank" class="popup-item"><i data-lucide="instagram"></i> Instagram</a>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div id="split-screen">
    <div class="split split-left group" onclick="enterWorld('engineer')">
      <div class="reveal-elem transform translate-y-10 opacity-0 transition-all duration-700">
        <h1 class="mega-text tea-font text-slate-900 group-hover:scale-105 transition-transform duration-700">ENGINEER</h1>
        <p class="text-slate-500 uppercase tracking-[0.3em] font-bold text-sm mt-4 text-center">Logic • Structure • Code</p>
        <div class="mt-8 flex justify-center opacity-0 group-hover:opacity-100 transition-opacity duration-500">
          <i data-lucide="arrow-right" class="w-8 h-8 text-slate-900"></i>
        </div>
      </div>
    </div>

    <div class="split split-right group" onclick="enterWorld('creator')">
      <div class="reveal-elem transform translate-y-10 opacity-0 transition-all duration-700">
        <h1 class="mega-text tea-font neon-glow group-hover:scale-105 transition-transform duration-700" data-text="TEA">TEA</h1>
        <p class="text-red-500 tea-font text-2xl mt-4 tracking-wide text-center">Third Eye Agency</p>
        <div class="mt-8 flex justify-center opacity-0 group-hover:opacity-100 transition-opacity duration-500">
          <i data-lucide="eye" class="w-8 h-8 text-red-500"></i>
        </div>
      </div>
    </div>
  </div>

  <!-- ENGINEER WORLD -->
  <div id="engineer-world" class="hidden-section">
    <div id="eng-home" class="section-track pt-8 pb-10 px-6 max-w-7xl mx-auto">
      <div class="inline-flex items-center space-x-2 px-3 py-1 bg-slate-100 text-slate-600 rounded text-xs font-bold mb-8 uppercase tracking-wider">
        <i data-lucide="terminal" class="w-3 h-3"></i><span>Aspiring Software Engineer</span>
      </div>

      <h1 class="display-text font-bold text-slate-900 mb-8 leading-[0.9] tracking-tighter">
        SOLVING PROBLEMS<br />WITH <span class="text-slate-400">INTELLIGENCE.</span>
      </h1>

      <p class="text-xl text-slate-600 max-w-2xl mb-12 leading-relaxed">
        Experience in Java, Python, SQL, and Web Technologies. Focused on building practical solutions through NLP, Machine Learning, and Automated Systems.
      </p>

      <div class="flex flex-wrap gap-4">
        <a href="#eng-projects" class="eng-social-btn eng-btn-primary" data-hover>View Projects</a>
        <a href="https://drive.google.com/uc?export=download&id=1SeoJmFrlHvjAzzOhYXv7yo_0vugso5zk" class="eng-social-btn eng-btn-outline" data-hover>Download Resume</a>
      </div>
    </div>

    <div id="eng-bio" class="max-w-7xl mx-auto px-6 py-20">
      <div class="bg-white p-10 rounded-2xl border border-slate-200 shadow-sm">
        <h3 class="text-sm font-bold uppercase mb-6 tracking-widest text-slate-400">About Me</h3>
        <p class="text-slate-700 text-lg leading-relaxed max-w-4xl">
          Engineering student building practical software with clean logic and strong problem-solving skills. I enjoy system design and converting ideas into real, working products.
          I also train MMA, lift regularly, and play chess and do designing.
        </p>
      </div>
    </div>

    <div id="eng-projects" class="section-track py-24 max-w-7xl mx-auto px-6">
      <h2 class="text-3xl font-bold text-slate-900 mb-16 uppercase tracking-tight">Selected Works</h2>

      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
        <div class="sde-card p-8 flex flex-col" data-hover>
          <div class="flex justify-between items-start mb-6">
            <i data-lucide="bar-chart-2" class="w-8 h-8 text-slate-800"></i>
            <a href="https://github.com/Lakshmikanthark" target="_blank" class="hover:text-blue-600"><i data-lucide="arrow-up-right"></i></a>
          </div>
          <h3 class="text-xl font-bold text-slate-800 mb-2">Demand Forecasting</h3>
          <p class="text-slate-500 text-sm mb-6 flex-grow">Linear Regression model for product demand. Integrated into a Flask dashboard with Chart.js visualization.</p>
          <div class="flex gap-2 text-xs font-bold uppercase text-slate-400"><span>Python</span> • <span>Flask</span> • <span>ML</span></div>
        </div>

        <div class="sde-card p-8 flex flex-col" data-hover>
          <div class="flex justify-between items-start mb-6">
            <i data-lucide="scan-line" class="w-8 h-8 text-slate-800"></i>
            <a href="https://github.com/Lakshmikanthark" target="_blank" class="hover:text-blue-600"><i data-lucide="arrow-up-right"></i></a>
          </div>
          <h3 class="text-xl font-bold text-slate-800 mb-2">AI Resume Scanner</h3>
          <p class="text-slate-500 text-sm mb-6 flex-grow">Uses Google Gemini AI to analyze resumes. Features automated re-generation, skill gap analysis, and ATS scoring.</p>
          <div class="flex gap-2 text-xs font-bold uppercase text-slate-400"><span>Gemini AI</span> • <span>LLM</span> • <span>SQLite</span></div>
        </div>

        <div class="sde-card p-8 flex flex-col" data-hover>
          <div class="flex justify-between items-start mb-6">
            <i data-lucide="film" class="w-8 h-8 text-slate-800"></i>
            <a href="https://github.com/Lakshmikanthark" target="_blank" class="hover:text-blue-600"><i data-lucide="arrow-up-right"></i></a>
          </div>
          <h3 class="text-xl font-bold text-slate-800 mb-2">Movie Recommender</h3>
          <p class="text-slate-500 text-sm mb-6 flex-grow">Content-based recommendation engine using cosine similarity on metadata. Interactive Streamlit UI.</p>
          <div class="flex gap-2 text-xs font-bold uppercase text-slate-400"><span>Streamlit</span> • <span>Pandas</span></div>
        </div>
      </div>
    </div>

    <div id="eng-contact" class="section-track bg-slate-50 border-t border-slate-200 pt-24 pb-48">
      <div class="max-w-7xl mx-auto px-6">
        <div class="grid grid-cols-1 md:grid-cols-2 gap-12 items-center">
          <div>
            <div class="flex items-center gap-2 mb-6">
              <span class="relative flex h-3 w-3">
                <span class="animate-ping absolute inline-flex h-full w-full rounded-full bg-green-400 opacity-75"></span>
                <span class="relative inline-flex rounded-full h-3 w-3 bg-green-500"></span>
              </span>
              <span class="text-sm font-bold text-slate-600 uppercase tracking-widest">Available for hire</span>
            </div>
            <h2 class="text-5xl font-bold text-slate-900 mb-6">Let's build together.</h2>
          </div>

          <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
            <a href="mailto:Lakshmikanthark20@gmail.com" class="eng-social-btn eng-btn-primary justify-start" data-hover>Email Me</a>
            <a href="tel:+919901456389" class="eng-social-btn eng-btn-outline justify-start" data-hover>+91 9901456389</a>
            <a href="https://www.linkedin.com/in/lakshmikantha-r-k" target="_blank" class="eng-social-btn eng-btn-outline justify-start" data-hover>LinkedIn</a>
            <a href="https://github.com/Lakshmikanthark" target="_blank" class="eng-social-btn eng-btn-outline justify-start" data-hover>GitHub</a>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- CREATOR WORLD -->
  <div id="creator-world" class="hidden-section relative min-h-screen bg-black text-white">
    <div class="mask-container" id="creator-world-top">
      <!-- Lazy video: use data-src -->
      <video class="masked-bg" autoplay muted loop playsinline preload="none">
        <source data-src="original-15a657f5c71980b123bb804536291ba8.mp4" type="video/mp4" />
      </video>
      <div class="mask-overlay"></div>

      <div class="mask-text">
        <p class="text-red-500 tracking-[1em] text-xs mb-6 font-bold">ESTD. 2025</p>
        <h1 class="mega-text tea-font neon-glow" data-text="TEA">TEA</h1>
        <p class="text-xl mt-4 font-light tracking-widest opacity-50">THIRD EYE AGENCY</p>
      </div>
    </div>

    <div class="relative z-10 bg-black pt-20">
      <div class="manifesto-scroller mb-20">
        <div class="manifesto-track">
          <span class="manifesto-text">VISION</span><span class="manifesto-text">CLARITY</span><span class="manifesto-text">IMPACT</span><span class="manifesto-text">EXECUTION</span>
          <span class="manifesto-text">VISION</span><span class="manifesto-text">CLARITY</span><span class="manifesto-text">IMPACT</span><span class="manifesto-text">EXECUTION</span>
        </div>
      </div>

      <div class="text-center mb-32 px-6">
        <p class="display-text text-gray-500 italic font-light leading-tight">"Move <span class="text-red-600 font-bold">Different</span>"</p>

        <div id="creator-bio" class="max-w-2xl mx-auto mt-24 text-left bg-[#111] p-10 border border-[#333] rounded-2xl shadow-[0_0_40px_rgba(0,0,0,0.5)]">
          <h3 class="tea-font text-3xl text-red-500 mb-6">THE CREATOR</h3>
          <p class="text-gray-400 text-lg leading-relaxed font-light">
            I explore visual storytelling through poster design, branding, video editing, cinematography, and drone shoots.
            I’m drawn to strong visuals, motion, and clarity in communication.
            Influenced by discipline in fitness and combat sports, I approach creativity with intent — creating visuals that don't just look good, but feel right.
          </p>
        </div>
      </div>

      <div class="mb-40">
        <div class="gallery-section">
          <div class="gallery-track" id="gallery-track"></div>
        </div>
      </div>

      <div class="max-w-7xl mx-auto px-6 mb-40" id="creator-work">
        <div class="flex items-end justify-between mb-12 border-b border-gray-800 pb-4">
          <h2 class="tea-font text-6xl text-white">CAPABILITIES</h2>
          <span class="text-red-500 tea-font text-2xl">01 — 04</span>
        </div>

        <div class="bento-grid">
          <div class="bento-item b-video" data-hover>
            <img src="POSTERS/1.png" class="bento-bg" alt="Video" loading="lazy" />
            <h3>VIBESTREET STUDIO</h3>
            <p>Social Media & Web Solutions.</p>
          </div>

          <div class="bento-item b-posters" onclick="openCircularGallery()" data-hover>
            <video class="bento-bg" autoplay loop muted playsinline preload="none">
              <source data-src="skull.mp4" type="video/mp4" />
            </video>
            <div class="absolute top-4 right-4 text-red-500">
              <i data-lucide="arrow-up-right" size="32"></i>
            </div>
            <h3>VISUAL DESIGN<br /><span class="text-red-500">& POSTERS</span></h3>
            <p class="mt-auto text-red-500">ENTER ARCHIVE →</p>
          </div>

          <div class="bento-item b-growth" data-hover>
            <video class="bento-bg" autoplay loop muted playsinline preload="none">
              <source data-src="gw.mp4" type="video/mp4" />
            </video>
            <h3>GROWTH</h3>
            <p>B2B Outreach & Digital Marketing.</p>
          </div>

          <div class="bento-item b-strategy" data-hover>
            <video class="bento-bg" autoplay loop muted playsinline preload="none">
              <source data-src="sh.mp4" type="video/mp4" />
            </video>
            <h3>STRATEGY</h3>
            <p>50+ Visual Assets & Campaigns.</p>
          </div>
        </div>
      </div>

      <div class="contact-section" id="creator-contact">
        <div class="contact-glass">
          <div class="grid grid-cols-1 lg:grid-cols-3 gap-12 items-center">
            <div class="flex flex-col items-center lg:items-start text-center lg:text-left gap-10">
              <div class="relative group">
                <img src="monkey-on-the-phone-e87w1ne9zw18qddo.gif" alt="Monkey on Phone" class="monkey-img relative z-10" style="max-width:300px;" />
              </div>
              <div>
                <h2 class="tea-font text-7xl mb-4 text-white">LET'S TALK</h2>
                <a href="mailto:Lakshmikanthark20@gmail.com"
                  class="inline-block bg-red-600 text-white px-12 py-4 tea-font text-2xl hover:bg-white hover:text-black transition-all transform hover:scale-105"
                  data-hover>BOOK A CALL</a>
              </div>
            </div>

            <div class="flex flex-col gap-6 pl-8 border-l border-gray-700">
              <div class="text-gray-400 tea-font text-xl tracking-widest mb-4">SOCIALS</div>
              <a href="mailto:Lakshmikanthark20@gmail.com" class="tea-link tea-font text-5xl text-white flex items-center justify-between group" data-hover><span>EMAIL</span></a>
              <a href="https://instagram.com/tea.bengaluru" target="_blank" class="tea-link tea-font text-5xl text-white flex items-center justify-between group" data-hover><span>INSTAGRAM</span></a>
              <a href="https://linkedin.com/in/lakshmikantha-r-k" target="_blank" class="tea-link tea-font text-5xl text-white flex items-center justify-between group" data-hover><span>LINKEDIN</span></a>
              <div class="mt-10 text-gray-500 font-mono text-xs uppercase tracking-widest">
                <p>© 2025 Third Eye Agency </p>
                <p>Bengaluru, India.</p>
              </div>
            </div>

            <div class="flex flex-col items-center lg:items-start text-center lg:text-left gap-10 pl-8 border-l border-gray-700">
              <div>
                <h2 class="tea-font text-7xl mb-4 text-white">HAVE WORK?</h2>
                <a href="mailto:Lakshmikanthark20@gmail.com"
                  class="inline-block bg-red-600 text-white px-12 py-4 tea-font text-2xl hover:bg-white hover:text-black transition-all transform hover:scale-105"
                  data-hover>HIRE ME</a>
              </div>
              <div class="relative group">
                <img src="monkey-laptop.gif" alt="New GIF" class="monkey-img relative z-10" style="max-width:300px;" />
              </div>
            </div>
          </div>
        </div>
      </div>

    </div>
  </div>

  <div id="circular-gallery">
    <div class="ring-bg-container">
      <img id="ring-bg-1" class="ring-bg-img active" src="" alt="" />
      <img id="ring-bg-2" class="ring-bg-img" src="" alt="" />
    </div>
    <div class="ring-center-text"><h2>TEA<br />ARCHIVE</h2><p>SCROLL TO EXPLORE</p></div>
    <div class="yza-header">
      <div class="yza-back" onclick="closeCircularGallery()" data-hover>← BACK</div>
      <div class="tea-font text-xl text-white">GALLERY</div>
    </div>
    <div class="ring-container" id="ring"></div>
    <div class="absolute bottom-10 left-0 w-full text-center text-gray-500 pointer-events-none mix-blend-difference">
      <p class="tea-font tracking-widest text-xl">DRAG OR SCROLL TO ROTATE</p>
    </div>
  </div>

  <div id="poster-modal" onclick="closeModal()">
    <span class="close-modal" data-hover>&times;</span>
    <img id="modal-img" src="" alt="Full Design" />
  </div>

  <script>
    // -----------------------------
    // PERFORMANCE FIXES + ORIGINAL LOGIC
    // -----------------------------

    const isMobile = window.innerWidth <= 768;

    // CONFIG
    const posterCount = 10;
    const posterPath = "";
    const posterExt = ".png";

    // Init icons AFTER scripts loaded
    window.addEventListener("DOMContentLoaded", () => {
      if (window.lucide) lucide.createIcons();
    });

    // Register GSAP safely
    window.addEventListener("DOMContentLoaded", () => {
      if (window.gsap && window.ScrollTrigger) {
        gsap.registerPlugin(ScrollTrigger);
      }
    });

    // Lenis smooth scroll (disable smooth on mobile for more performance)
    let lenis = null;
    function initLenis() {
      if (!window.Lenis) return;

      if (isMobile) {
        // mobile: keep native scroll (fastest)
        return;
      }

      lenis = new Lenis({
        duration: 1.2,
        easing: (t) => Math.min(1, 1.001 - Math.pow(2, -10 * t)),
        direction: "vertical",
        smooth: true,
      });

      function raf(time) {
        lenis.raf(time);
        requestAnimationFrame(raf);
      }
      requestAnimationFrame(raf);
    }
    initLenis();

    // Save scroll
    window.addEventListener("beforeunload", () => {
      sessionStorage.setItem("scrollPos", window.scrollY);
    });

    // Elements
    const cursorDot = document.querySelector(".cursor-dot");
    const cursorOutline = document.querySelector(".cursor-outline");

    // Cursor - disable on mobile
    function moveCursor(x, y) {
      cursorDot.style.left = `${x}px`;
      cursorDot.style.top = `${y}px`;

      // Avoid heavy animate spam on mobile / low power
      cursorOutline.style.left = `${x}px`;
      cursorOutline.style.top = `${y}px`;
    }

    if (!isMobile) {
      window.addEventListener("mousemove", (e) => moveCursor(e.clientX, e.clientY));
    }

    // Hover interactions
    document.querySelectorAll("[data-hover]").forEach((el) => {
      el.addEventListener("mouseenter", () => document.body.classList.add("hovered"));
      el.addEventListener("mouseleave", () => document.body.classList.remove("hovered"));

      el.addEventListener("touchstart", () => document.body.classList.add("hovered"), { passive: true });
      el.addEventListener("touchend", () => document.body.classList.remove("hovered"));
    });

    // NAV scroll interception
    document.querySelectorAll(".nav-link").forEach((link) => {
      link.addEventListener("click", (e) => {
        const href = link.getAttribute("href");
        if (href && href.startsWith("#")) {
          e.preventDefault();

          // Mobile native scroll for speed
          if (!lenis) {
            document.querySelector(href)?.scrollIntoView({ behavior: "smooth", block: "start" });
          } else {
            lenis.scrollTo(href, { offset: -50 });
          }
        }
      });
    });

    // Sections
    const splitScreen = document.getElementById("split-screen");
    const engWorld = document.getElementById("engineer-world");
    const creatorWorld = document.getElementById("creator-world");
    const navPillContainer = document.querySelector(".nav-pill-container");
    const navPill = document.querySelector(".nav-pill");
    const navHome = document.getElementById("nav-home");
    const navWork = document.getElementById("nav-work");
    const navAbout = document.getElementById("nav-about");

    // Preloader animation
    window.addEventListener("load", () => {
      const savedWorld = localStorage.getItem("activeWorld");
      const savedScroll = sessionStorage.getItem("scrollPos");

      // If user already selected world -> instant load
      if (savedWorld) {
        document.getElementById("preloader").style.display = "none";
        enterWorld(savedWorld, false);

        // show nav instantly
        navPillContainer.style.opacity = 1;
        document.querySelectorAll(".reveal-elem").forEach((el) => {
          el.style.opacity = 1;
          el.style.transform = "translateY(0)";
        });

        if (savedScroll) {
          setTimeout(() => {
            window.scrollTo(0, parseFloat(savedScroll));
          }, 50);
        }

        initLazyVideos();
        return;
      }

      // First visit: run preloader only if GSAP available
      if (window.gsap) {
        const tl = gsap.timeline();
        setTimeout(() => {
          tl.to(".loader-logo", { opacity: 0, duration: 0.5 })
            .to(".curtain-top", { y: "-100%", duration: 1.2, ease: "power4.inOut" }, "split")
            .to(".curtain-bottom", { y: "100%", duration: 1.2, ease: "power4.inOut" }, "split")
            .set("#preloader", { display: "none" })
            .to(".reveal-elem", { y: 0, opacity: 1, duration: 0.8, stagger: 0.12, ease: "power3.out" }, "-=0.3")
            .to(".nav-pill-container", { opacity: 1, duration: 0.6 }, "-=0.6");
        }, 700);
      } else {
        // Fallback: no gsap loaded
        document.getElementById("preloader").style.display = "none";
        navPillContainer.style.opacity = 1;
      }

      initLazyVideos();
    });

    // World functions
    function enterWorld(type, pushHistory = true) {
      if (pushHistory) {
        history.pushState({ world: type }, "", `#${type}`);
      }
      localStorage.setItem("activeWorld", type);
      applyWorldState(type, !pushHistory);
    }

    function applyWorldState(type, isInstant = false) {
      document.body.classList.remove("hovered");

      if (isInstant) {
        splitScreen.style.transition = "none";
        splitScreen.style.transform = "translateY(-100%)";
        splitScreen.offsetHeight;
        splitScreen.style.transition = "";
      } else {
        splitScreen.style.transform = "translateY(-100%)";
      }

      const delay = isInstant ? 0 : 600;

      setTimeout(() => {
        if (type === "engineer") {
          engWorld.classList.remove("hidden-section");
          creatorWorld.classList.add("hidden-section");

          document.body.style.backgroundColor = "#f8fafc";
          document.body.style.cursor = "auto";
          if (cursorDot) cursorDot.style.display = "none";
          if (cursorOutline) cursorOutline.style.display = "none";

          navPillContainer.classList.add("expanded");
          navPill.classList.remove("red-mode");
          navPill.classList.add("blue-mode");

          navHome.setAttribute("href", "#eng-home");
          navWork.setAttribute("href", "#eng-projects");
          navAbout.setAttribute("href", "#eng-bio");
        }

        if (type === "creator") {
          creatorWorld.classList.remove("hidden-section");
          engWorld.classList.add("hidden-section");

          document.body.style.backgroundColor = "#000";
          if (!isMobile) {
            if (cursorDot) cursorDot.style.display = "block";
            if (cursorOutline) cursorOutline.style.display = "block";
          }

          navPillContainer.classList.add("expanded");
          navPill.classList.remove("blue-mode");
          navPill.classList.add("red-mode");

          navHome.setAttribute("href", "#creator-world-top");
          navWork.setAttribute("href", "#creator-work");
          navAbout.setAttribute("href", "#creator-bio");

          initCreatorAnimations();
          initGallery();
          initLazyVideos();
        }

        if (window.lucide) lucide.createIcons();
      }, delay);
    }

    function handleSwitch() {
      localStorage.removeItem("activeWorld");
      sessionStorage.removeItem("scrollPos");
      goBack();
      history.replaceState(null, null, " ");
    }

    function goBack() {
      engWorld.classList.add("hidden-section");
      creatorWorld.classList.add("hidden-section");
      splitScreen.style.transform = "translateY(0)";
      document.body.style.backgroundColor = "#000";

      navPillContainer.classList.remove("expanded");
      navPill.classList.remove("blue-mode", "red-mode");

      document.getElementById("contact-popup")?.classList.remove("active");
    }

    window.addEventListener("popstate", (event) => {
      if (event.state && event.state.world) {
        enterWorld(event.state.world, false);
      } else {
        goBack();
      }
    });

    // Contact popup
    function toggleContact() {
      const popup = document.getElementById("contact-popup");
      popup.classList.toggle("active");
    }

    document.addEventListener("click", (e) => {
      const popup = document.getElementById("contact-popup");
      const trigger = document.getElementById("contact-trigger");
      if (popup && trigger && !popup.contains(e.target) && !trigger.contains(e.target)) {
        popup.classList.remove("active");
      }
    });

    // CREATOR animations (lighter on mobile)
    function initCreatorAnimations() {
      if (!window.ScrollTrigger || !window.gsap) return;

      ScrollTrigger.getAll().forEach((t) => t.kill());

      if (isMobile) return; // ✅ huge performance gain: no pin + scrub on mobile

      gsap.to(".mask-text", {
        opacity: 0,
        scale: 1.5,
        scrollTrigger: {
          trigger: ".mask-container",
          start: "top top",
          end: "+=900",
          scrub: 1,
        },
      });

      gsap.utils.toArray(".bento-item").forEach((item) => {
        const bg = item.querySelector(".bento-bg");
        if (!bg) return;
        gsap.to(bg, {
          yPercent: 20,
          ease: "none",
          scrollTrigger: { trigger: item, scrub: true },
        });
      });
    }

    // Gallery
    const track = document.getElementById("gallery-track");
    let isHovered = false;
    let autoScrollRAF = null;

    function autoScroll() {
      if (!track) return;
      if (!isHovered) track.scrollLeft += 1;
      autoScrollRAF = requestAnimationFrame(autoScroll);
    }

    // ✅ Disable infinite loop on mobile
    if (!isMobile) {
      autoScroll();
      track?.addEventListener("mouseenter", () => (isHovered = true));
      track?.addEventListener("mouseleave", () => (isHovered = false));
    }

    // Still allow touch interactions
    track?.addEventListener("touchstart", () => { isHovered = true; }, { passive: true });
    track?.addEventListener("touchend", () => { setTimeout(() => (isHovered = false), 1200); });

    function initGallery() {
      if (!track) return;
      if (track.children.length > 0) return;

      for (let j = 0; j < 2; j++) {
        for (let i = 1; i <= posterCount; i++) {
          const src = `${posterPath}${i}${posterExt}`;
          const div = document.createElement("div");
          div.className = "poster-item";
          div.setAttribute("data-hover", "");
          div.onclick = function () { openModal(this); };
          div.innerHTML = `<img src="${src}" loading="lazy">`;
          track.appendChild(div);
        }
      }
    }

    // Lazy load all videos (data-src)
    function initLazyVideos() {
      const videos = document.querySelectorAll("video");
      const sources = document.querySelectorAll("video source[data-src]");

      if (!("IntersectionObserver" in window)) {
        // fallback: load all
        sources.forEach((s) => {
          s.src = s.dataset.src;
          s.removeAttribute("data-src");
        });
        videos.forEach((v) => v.load());
        return;
      }

      const obs = new IntersectionObserver(
        (entries, observer) => {
          entries.forEach((entry) => {
            if (!entry.isIntersecting) return;
            const video = entry.target;
            const source = video.querySelector("source[data-src]");
            if (source) {
              source.src = source.dataset.src;
              source.removeAttribute("data-src");
              video.load();
            }
            observer.unobserve(video);
          });
        },
        { rootMargin: "300px" }
      );

      videos.forEach((v) => obs.observe(v));
    }

    // 3D Ring (unchanged)
    const overlay = document.getElementById("circular-gallery");
    const ring = document.getElementById("ring");
    let ringState = { current: 0, target: 0, active: false };
    let currentBgIndex = 1;
    let activeBg = 1;

    function initRing() {
      ring.innerHTML = "";
      const radius = isMobile ? 400 : 900;
      const step = 360 / posterCount;

      for (let i = 1; i <= posterCount; i++) {
        const src = `${posterPath}${i}${posterExt}`;
        const div = document.createElement("div");
        div.className = "ring-item";
        div.onclick = function () { openModal(this); };
        div.innerHTML = `<img src="${src}" loading="lazy" />`;
        const angle = (i - 1) * step;
        div.style.transform = `rotateY(${angle}deg) translateZ(${radius}px)`;
        ring.appendChild(div);
      }
      updateRingBackground(1);
    }

    function updateRingBackground(index) {
      let normalizedIndex = index % posterCount;
      if (normalizedIndex <= 0) normalizedIndex += posterCount;
      if (normalizedIndex === currentBgIndex) return;
      currentBgIndex = normalizedIndex;

      const newSrc = `${posterPath}${normalizedIndex}${posterExt}`;
      const bg1 = document.getElementById("ring-bg-1");
      const bg2 = document.getElementById("ring-bg-2");

      if (activeBg === 1) {
        bg2.src = newSrc;
        bg2.classList.add("active");
        bg1.classList.remove("active");
        activeBg = 2;
      } else {
        bg1.src = newSrc;
        bg1.classList.add("active");
        bg2.classList.remove("active");
        activeBg = 1;
      }
    }

    function animateRing() {
      if (!ringState.active) return;
      ringState.current += (ringState.target - ringState.current) * 0.05;
      ring.style.transform = `rotateY(${ringState.current}deg)`;

      const rotation = -ringState.current;
      const step = 360 / posterCount;
      const index = Math.round(rotation / step);
      updateRingBackground(index + 1);

      requestAnimationFrame(animateRing);
    }

    function openCircularGallery() {
      initRing();
      overlay.classList.add("active");
      ringState.active = true;
      document.body.style.overflow = "hidden";
      if (lenis) lenis.stop();
      animateRing();
    }

    function closeCircularGallery() {
      overlay.classList.remove("active");
      ringState.active = false;
      document.body.style.overflow = "";
      if (lenis) lenis.start();
    }

    window.addEventListener("wheel", (e) => {
      if (!ringState.active) return;
      ringState.target -= e.deltaY * 0.15;
    });

    let touchStartX = 0;
    window.addEventListener("touchstart", (e) => {
      touchStartX = e.touches[0].clientX;
    }, { passive: true });

    window.addEventListener("touchmove", (e) => {
      if (!ringState.active) return;
      let touchX = e.touches[0].clientX;
      let deltaX = touchStartX - touchX;
      ringState.target -= deltaX * 0.3;
      touchStartX = touchX;
    }, { passive: true });

    // Modal
    const modal = document.getElementById("poster-modal");
    const modalImg = document.getElementById("modal-img");

    function openModal(element) {
      const img = element.querySelector("img");
      if (!img) return;
      modalImg.src = img.src;
      modal.classList.add("open");
    }
    function closeModal() {
      modal.classList.remove("open");
    }
  </script>
</body>
</html>
